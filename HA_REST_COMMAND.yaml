# Home Assistant REST Command Configuration
# ===========================================
# Add this block to your configuration.yaml to enable the generic API logging
# feature used by the 'log_health_metric' script.
#
# Prerequisites:
# 1. Add 'hahealth_api_key' to secrets.yaml.
# 2. Add 'hahealth_webhook_url' to secrets.yaml (e.g., "http://192.168.1.50:8000/api/webhook/health").
#
# Usage:
# This command is called internally by script.log_health_metric when method="api".

rest_command:
  hahealth_log_generic:
    # URL structure: http://<IP>:8000/api/webhook/health
    url: !secret hahealth_webhook_url
    method: POST
    headers:
      X-Webhook-Secret: !secret hahealth_api_key
      Content-Type: application/json
    # The payload is passed as a string variable 'json_payload' from the script
    payload: "{{ json_payload }}"
